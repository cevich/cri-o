---

- name: These only run on RedHat-ish systems (for now)
  assert:
    that:
        - 'ansible_distribution in ["RedHat", "Fedora"]'
        - 'artifacts is defined'
        - 'cri_o_dest_path | default("", True) | trim | length'

- name: Directory exists for smoke test output
  file:
    path: "{{ artifacts }}"
    state: directory

# STUB: This should be replaced by more comprehensive testing stuffs
- name: Execute commands for testing that installed RPM(s) are functioning
  shell: |
    set -ex;
    (
        cd "{{ cri_o_dest_path }}";
        systemctl restart cri-o;
        crioctl --version;
    ) 2>&1 | tee -a {{ artifacts }}/rpmsmoke.txt
